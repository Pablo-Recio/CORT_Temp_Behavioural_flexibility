<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ms</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="ms_files/libs/clipboard/clipboard.min.js"></script>
<script src="ms_files/libs/quarto-html/quarto.js"></script>
<script src="ms_files/libs/quarto-html/popper.min.js"></script>
<script src="ms_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ms_files/libs/quarto-html/anchor.min.js"></script>
<link href="ms_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ms_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ms_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ms_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ms_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="ms_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="ms_files/libs/tabwid-1.1.3/tabwid.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Behavioural flexibility, <strong>the ability to adapt behaviour to changing environments</strong> (<strong>REFS</strong>), is considered crucial for invasion success <span class="citation" data-cites="sol2002behavioural">[<a href="#ref-sol2002behavioural" role="doc-biblioref"><strong>sol2002behavioural?</strong></a>]</span>. In general, species with higher behavioural flexibility are more likely to survive and establish in new habitats (<strong>REFS</strong>) as behaving flexibly enhances their capacity to exploit new resources and face new challenges (<strong>REFS</strong>).</p>
<p>adaptive flexibility hypothesis says that flexibility may be relevant in early and late stages of invassion (Wright et al 2010). But at the same time behavioural flexibility it is related to relative brain size (Sol et al 2002, 2008), that may be more fixed than we thought (controversy with Wright et al??). In contrast, other hyoptheses predict this is constant, or there is individual variation in beh flexibility (Wright et al 2010). Since some aspects of early environment can play a prominent role in shaping neural substrate, we hypothesize that beh flexibility may be affected by early environment. Also, since beh flexibility is advantageous at different stages of colonization (<strong>REFS</strong>), invassive species may be able to maintain this behavioral flexibility through generations. In other words, there may be some mechanisms in invassive species to avoid early developmental constraints. CORT can be essential in this process as it is associated to vertebrates response to environmental changes, and it is known to impact brain development (Zhu et al 2004). Also, temperature may be relevant, since it affects brain development in ectotherms, it can be one of the main environmental changes to face by animals, andvertebrates reponse to changes in temeprature is also associated with the production of CORT (Crino et al 2023).</p>
<p>Here, we aim to study the effects of prenatal environment on behavioural flexibility in the invassion ecology context. To do so, we employed as our model species the delicate skink (<em>Lampropholis delicata</em>) and the common garden skink (<em>L. guichenoti</em>). These two species are closely related and share similar life history traits <span class="citation" data-cites="chapple_know_2011 chapple_biology_2014">[<a href="#ref-chapple_know_2011" role="doc-biblioref">1</a>,<a href="#ref-chapple_biology_2014" role="doc-biblioref">2</a>]</span>, but only <em>L. delicata</em> has been succesful in colonising different areas around the globe (<strong>REFS</strong>). Some studies have shown differences in personality traits between these two species that can be related to higher behavioural flexibility in <em>L. delicata</em> (<strong>REFS</strong>), and are likely key for its invassive success (<strong>REFS</strong>). Our goal in this study was to investigate if behavioural flexibility is affected by the prenatal environment and the species specific response to it. Particularly, we were interested in the interactive effects of prenatal temperature and Corticosterone (CORT) - the main type of GC in reptiles <span class="citation" data-cites="Crino_2023">[<a href="#ref-Crino_2023" role="doc-biblioref">3</a>]</span> - because CORT is usually associated to vertebrates response to changes in temeprature <span class="citation" data-cites="Crino_2023">[<a href="#ref-Crino_2023" role="doc-biblioref">3</a>]</span>, and both factors are known to impact brain development <span class="citation" data-cites="coomber_independent_1997 zhu_prenatal_2004">[<a href="#ref-coomber_independent_1997" role="doc-biblioref">4</a>,<a href="#ref-zhu_prenatal_2004" role="doc-biblioref">5</a>]</span>. We hypothesized that, since behavioural flexibility is advantageous at different stages of colonization (<strong>REFS</strong>), invassive species may be able to maintain this behavioral flexibility through generations. In other words, there may be some mechanisms in invassive species to avoid early</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<section id="experimental-design" class="level4">
<h4 class="anchored" data-anchor-id="experimental-design">Experimental design</h4>
<p>We employed juveniles of both species, <em>L. delicata</em> and <em>L. guichenoti</em> that came from a breeding colony kept in the lab (details of breeding colony and husbandry in Supplementary Material). To see the effect of prenatal CORT and temperature, eggs were topically supplied with 5µL of CORT dissolved in 70% Ethanol and 30% DMSO (‘CORT’ treatment) or the same volume of the vehicle (‘Control’), and were then incubated at different temperatures (‘Cold’ – 23ºC ± 3ºC or ‘Hot’ – 30ºC ± 3ºC) until hatching.<br>
To estimate behavioural flexibility, we examined lizards’ performance in a reversal learning task using colour as the main conditioned stimulus and food (frozen small <em>A. domestica</em>) as a reward (see <a href="#fig-Methods">Fig.&nbsp;1</a>). The learning test was divided in three main phases: there was first a habituation phase where lizards had to learn to eat from white 3D-printed PLA ramps (9 L x 4 W x 5 H cm); then a second phase where lizards had to associate the attainability of food with one colour; and finally the reversal task where the colour associated with the attainable food was changed (<a href="#fig-Methods">Fig.&nbsp;1</a> B). In associative and reversal tasks we used using three different ramps that were identical in size and shape to the ones for the habituation phase. The colours of the ramps were green, red, and blue, as previous studies demonstrate that squamates can discriminate between these colours <span class="citation" data-cites="Baden_Osorio_2019_Vert_vision">[<a href="#ref-Baden_Osorio_2019_Vert_vision" role="doc-biblioref">6</a>]</span>. To control for potential colour biases, we assigned one group of lizards to associate the blue ramp with the attainable food in the associative task and the red ramp in the reversal, while the other group was assigned red as correct for the associative and blue for the reversal. In all trials, the position of the feeders was changed randomly to ensure subjects were using colour rather than spatial cues for the association. To avoid the use of chemical cues, we placed the food reward in all three ramps, but in two of them the cricket was covered by small white lids with holes on the top. Lizards were tested once daily between 11 to 12 am, when lizards are active. The training phase lasted 38 days, the Associaive learning task 35, and the Reversal learning task 40 days. We recorded and analysed manually all trials form the learning phases using a standard video player (IINA). PR was the main researcher analysing the data, and was blinded to the lizards’ treatment until the end of the analyses. We used as the main variable whether the animal chose the correct ramp first or not. We considered that a choice was made if the head of the lizard was inside the well of one of the ramps. We considered a trial failed if there was no choice in one hour of recording and those trials were considered as ‘non data’ in the analyses. Here, we analysed the data of the reversal as a measure of behavioural flexibility. As such, we only included in our analyses those individuals who passed a learning criterion of 80% correct choices in the last 10 trials of the associative task.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-Methods" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./Others/BEHFLEX_FIG_1.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Fig&nbsp;1— Experimental design of early environment manipulation (<strong>A</strong>) and learning tasks (<strong>B</strong>). Stages 1-3 indicate the different phases of the habituation process. In the associative and reversal tasks, white lids show the ramps where the food reward was not attainable.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="statistical-analyses" class="level4">
<h4 class="anchored" data-anchor-id="statistical-analyses">Statistical analyses</h4>
<p>We also considered individuals to be reinforced if the cricket was eaten after the test independently of whether their initial choice was correct or not.<br>
<strong>As such, we run a total of different 8 models employing Bayesian multilevel models using the brm function from the brms package (<span class="citation" data-cites="burkner2017brms">[<a href="#ref-burkner2017brms" role="doc-biblioref">7</a>]</span>) in Quarto (<span class="citation" data-cites="Allaire_Quarto_2022">[<a href="#ref-Allaire_Quarto_2022" role="doc-biblioref">8</a>]</span>). Each model consisted of four parallel chains of 3000 iterations, with a warm up interval of 1000 iterations.’Choice’, i.e.&nbsp;whether the individual chose correct (1) or not (0) was used as the response variable. The fixed effects of the model included a triple interaction between: trial (‘Associative trial’ or ‘Reversal trial’) as a numeric variable, and hormone treatmet (‘CORT’ versus ‘Control’) and the temperature at which eggs were incubated (‘Cold’ versus ‘Hot’) as factors. For the random effects, we employed lizard identity as a random intercept, and as a random slope we included the variable trial (‘Associative’ or ‘Reversal’) within each level of lizard identity. We used the resulting posterior of these models to evaluate learning differences between treatments within and between species and colour assigned. More specifically, we calculated learning slopes by using the estimates of the trial variable per each level of the hormone-temperature interaction (‘Treatments’); values bigger from zero were considered as evidence of learning, while those less or equal to zero not. We used the pmcmc method to test whether those slopes or the comparissons between ‘Treatments’ (e.g.&nbsp;slope for ‘CORT-Cold’ lizards minus ‘CORT-Hot’ lizards) were different from zero (two-tailed tests). We considered statistical significance if p-value &lt; 0.05.</strong></p>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>Originally, we started with 96 lizards, 48 per species and 12 per treatment per species. However, due to natural mortality (n = 11), no completion of the training stage (n = 1), or no motivation during the learning tasks (n = 3; see above), we ended up with a total of 81 lizards. Final sample sizes per treatment and species are disclosed on <a href="#tbl-data">Table&nbsp;1</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-data" class="anchored">

<div class="tabwid"><style>.cl-1c87ab94{}.cl-1c802220{font-family:'Times New Roman';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1c802248{font-family:'Times New Roman';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1c802249{font-family:'Times New Roman';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1c833cd0{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1c8353c8{width:1.091in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c8353d2{width:1.555in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c8353dc{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c8353dd{width:1.087in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c8353e6{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c8353e7{width:1.091in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c8353f0{width:1.555in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c8353f1{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c8353fa{width:1.087in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c8353fb{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835404{width:1.091in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835405{width:1.555in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c83540e{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c83540f{width:1.087in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835418{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835419{width:1.091in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835422{width:1.555in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835423{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c83542c{width:1.087in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835436{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835437{width:1.091in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835438{width:1.555in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835440{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c835441{width:1.087in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1c83544a{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-1c87ab94"><caption>Table&nbsp;1—  <p>Estimates of Associative learning slope for all the different
treatments per each task, species and group. Mean shows the aritmetic
mean of the estimates obtained from the posteriors of the model, and 95%
CI indicates the 95% confidence interval of the mean. All p-values were
obtained using pmcmc and test the hypothesis that the mean is equal to
zero. In bold, those values that are significant (p-value &lt;0.05)</p> </caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-1c8353c8"><p class="cl-1c833cd0"><span class="cl-1c802220">Specie</span></p></th><th class="cl-1c8353d2"><p class="cl-1c833cd0"><span class="cl-1c802220">Treatment</span></p></th><th class="cl-1c8353dc"><p class="cl-1c833cd0"><span class="cl-1c802220">Mean</span></p></th><th class="cl-1c8353dd"><p class="cl-1c833cd0"><span class="cl-1c802220">95% CI</span></p></th><th class="cl-1c8353e6"><p class="cl-1c833cd0"><span class="cl-1c802220">p-value</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-1c8353e7"><p class="cl-1c833cd0"><span class="cl-1c802248">L. delicata</span></p></td><td class="cl-1c8353f0"><p class="cl-1c833cd0"><span class="cl-1c802220">CORT-Cold (n = 4)</span></p></td><td class="cl-1c8353f1"><p class="cl-1c833cd0"><span class="cl-1c802249">0.052</span></p></td><td class="cl-1c8353fa"><p class="cl-1c833cd0"><span class="cl-1c802249">0.022 , 0.083</span></p></td><td class="cl-1c8353fb"><p class="cl-1c833cd0"><span class="cl-1c802249">0.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1c8353e7"><p class="cl-1c833cd0"><span class="cl-1c802248"></span></p></td><td class="cl-1c8353f0"><p class="cl-1c833cd0"><span class="cl-1c802220">Control-Cold (n = 5)</span></p></td><td class="cl-1c8353f1"><p class="cl-1c833cd0"><span class="cl-1c802249">0.066</span></p></td><td class="cl-1c8353fa"><p class="cl-1c833cd0"><span class="cl-1c802249">0.037 , 0.096</span></p></td><td class="cl-1c8353fb"><p class="cl-1c833cd0"><span class="cl-1c802249">0.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1c8353e7"><p class="cl-1c833cd0"><span class="cl-1c802248"></span></p></td><td class="cl-1c8353f0"><p class="cl-1c833cd0"><span class="cl-1c802220">CORT-Hot (n = 3)</span></p></td><td class="cl-1c8353f1"><p class="cl-1c833cd0"><span class="cl-1c802249">0.073</span></p></td><td class="cl-1c8353fa"><p class="cl-1c833cd0"><span class="cl-1c802249">0.035 , 0.112</span></p></td><td class="cl-1c8353fb"><p class="cl-1c833cd0"><span class="cl-1c802249">0.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1c835404"><p class="cl-1c833cd0"><span class="cl-1c802248"></span></p></td><td class="cl-1c835405"><p class="cl-1c833cd0"><span class="cl-1c802220">Control-Hot (n = 7)</span></p></td><td class="cl-1c83540e"><p class="cl-1c833cd0"><span class="cl-1c802249">0.045</span></p></td><td class="cl-1c83540f"><p class="cl-1c833cd0"><span class="cl-1c802249">0.022 , 0.069</span></p></td><td class="cl-1c835418"><p class="cl-1c833cd0"><span class="cl-1c802249">0.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1c835419"><p class="cl-1c833cd0"><span class="cl-1c802248">L. guichenoti</span></p></td><td class="cl-1c835422"><p class="cl-1c833cd0"><span class="cl-1c802220">CORT-Cold (n = 3)</span></p></td><td class="cl-1c835423"><p class="cl-1c833cd0"><span class="cl-1c802249">0.068</span></p></td><td class="cl-1c83542c"><p class="cl-1c833cd0"><span class="cl-1c802249">0.013 , 0.125</span></p></td><td class="cl-1c835436"><p class="cl-1c833cd0"><span class="cl-1c802249">0.023</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1c8353e7"><p class="cl-1c833cd0"><span class="cl-1c802248"></span></p></td><td class="cl-1c8353f0"><p class="cl-1c833cd0"><span class="cl-1c802220">Control-Cold (n = 3)</span></p></td><td class="cl-1c8353f1"><p class="cl-1c833cd0"><span class="cl-1c802249">0.086</span></p></td><td class="cl-1c8353fa"><p class="cl-1c833cd0"><span class="cl-1c802249">0.028 , 0.148</span></p></td><td class="cl-1c8353fb"><p class="cl-1c833cd0"><span class="cl-1c802249">0.003</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1c8353e7"><p class="cl-1c833cd0"><span class="cl-1c802248"></span></p></td><td class="cl-1c8353f0"><p class="cl-1c833cd0"><span class="cl-1c802220">CORT-Hot (n = 5)</span></p></td><td class="cl-1c8353f1"><p class="cl-1c833cd0"><span class="cl-1c802249">0.072</span></p></td><td class="cl-1c8353fa"><p class="cl-1c833cd0"><span class="cl-1c802249">0.029 , 0.115</span></p></td><td class="cl-1c8353fb"><p class="cl-1c833cd0"><span class="cl-1c802249">0.002</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1c835437"><p class="cl-1c833cd0"><span class="cl-1c802248"></span></p></td><td class="cl-1c835438"><p class="cl-1c833cd0"><span class="cl-1c802220">Control-Hot (n = 7)</span></p></td><td class="cl-1c835440"><p class="cl-1c833cd0"><span class="cl-1c802249">0.066</span></p></td><td class="cl-1c835441"><p class="cl-1c833cd0"><span class="cl-1c802249">0.03 , 0.104</span></p></td><td class="cl-1c83544a"><p class="cl-1c833cd0"><span class="cl-1c802249">0.001</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
<p>We did not find any significant differences between treatments in <em>L. delicata</em> (‘Control-Cold’ - ‘CORT-Cold’ = 0.015, p- value = 0.494; ‘Control-Hot’ - ‘CORT-Hot’ = -0.027, p- value = 0.23; ‘Control-Hot’ - ‘Control-Cold’ = -0.021, p-value = 0.266; ‘CORT-Hot’ - ‘CORT-Cold’ = 0.021, p-value = 0.41) (see <a href="#fig-results">Fig.&nbsp;2</a>) or <em>L. guichenoti</em> (‘Control-Cold’ - ‘CORT-Cold’ = 0.018, p- value = 0.647; ‘Control-Hot’ - ‘CORT-Hot’ = -0.006, p- value = 0.832; ‘Control-Hot’ - ‘Control-Cold’ = -0.02, p-value = 0.563; ‘CORT-Hot’ - ‘CORT-Cold’ = 0.004, p-value = 0.908) (see <a href="#fig-results">Fig.&nbsp;2</a>). When pooled together, we did not find any effect of incubation temperature (<em>L. delicata</em>: ‘Hot’ learning slope - ‘Cold’ learning slope = 0, p-value = 0.996; <em>L. guichenoti</em>: ‘Hot’ learning slope - ‘Cold’ learning slope = -0.016, p-value = 0.762) or the hormone (<em>L. delicata</em>: ‘Control’ learning slope - ‘CORT’ learning slope = -0.012, p-value = 0.699;<em>L. guichenoti</em>: ‘Control’ learning slope - ‘CORT’ learning slope = 0.012, p-value = 0.795) when groups were pooled. Finally, we did not find any significant differences when we compared the estimated slopes between species for the reversal task (<em>L. delicata</em> - <em>L. guichenoti</em> = -0.056, p-value = 0.353).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-results" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./output/figures/figure_results.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Fig&nbsp;2— Predicted probability of choosing the correct feeder first over trials. The lines represent the mean predicted probability of choosing the correct feeder first, and the shaded areas represent the standard deviation of the mean; both obtained by using the slope and intercept estimates from the posterior distributions. The different colours represent the different treatments.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-chapple_know_2011" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Chapple DG, Simmonds SM, Wong BBM. 2011 Know when to run, know when to hide: Can behavioral differences explain the divergent invasion success of two sympatric lizards?: <span>Invasion</span> <span>Success</span> of <span>Two</span> <span>Sympatric</span> <span>Lizards</span>. <em>Ecology and Evolution</em> <strong>1</strong>, 278–289. (doi:<a href="https://doi.org/10.1002/ece3.22">10.1002/ece3.22</a>)</div>
</div>
<div id="ref-chapple_biology_2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Chapple DG, Miller KA, Chaplin K, Barnett L, Thompson MB, Bray RD. 2014 Biology of the invasive delicate skink (<span>Lampropholis</span> delicata) on <span>Lord</span> <span>Howe</span> <span>Island</span>. <em>Australian Journal of Zoology</em> <strong>62</strong>, 498. (doi:<a href="https://doi.org/10.1071/ZO14098">10.1071/ZO14098</a>)</div>
</div>
<div id="ref-Crino_2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Crino OL, Bonduriansky R, Martin LB, Noble DWA. 2023 A conceptual framework for understanding stressinduced physiological and transgenerational effects on population responses to climate change. <em>Evolution Letters</em> </div>
</div>
<div id="ref-coomber_independent_1997" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Coomber P, Crews D, Gonzalez-Lima F. 1997 Independent effects of incubation temperature and gonadal sex on the volume and metabolic capacity of brain nuclei in the leopard gecko (<span>Eublepharis</span> macularius), a lizard with temperature-dependent sex determination. <em>The Journal of Comparative Neurology</em> <strong>380</strong>, 409–421. (doi:<a href="https://doi.org/10.1002/(SICI)1096-9861(19970414)380:3<409::AID-CNE9>3.0.CO;2-6">10.1002/(SICI)1096-9861(19970414)380:3&lt;409::AID-CNE9&gt;3.0.CO;2-6</a>)</div>
</div>
<div id="ref-zhu_prenatal_2004" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Zhu Z, Li X, Chen W, Zhao Y, Li H, Qing C, Jia N, Bai Z, Liu J. 2004 Prenatal stress causes gender-dependent neuronal loss and oxidative stress in rat hippocampus. <em>Journal of Neuroscience Research</em> <strong>78</strong>, 837–844. (doi:<a href="https://doi.org/10.1002/jnr.20338">10.1002/jnr.20338</a>)</div>
</div>
<div id="ref-Baden_Osorio_2019_Vert_vision" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Baden T, Osorio D. 2019 The retinal basis of vertebrate color vision. <em>Annual Review of Vision Science</em>, 177–200.</div>
</div>
<div id="ref-burkner2017brms" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Bürkner P-C. 2017 Brms: An r package for bayesian multilevel models using stan. <em>Journal of statistical software</em> <strong>80</strong>, 1–28.</div>
</div>
<div id="ref-Allaire_Quarto_2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Allaire JJ, Teague C, Scheidegger C, Xie Y, Dervieux C. 2022 <span>Quarto</span>. (doi:<a href="https://doi.org/10.5281/zenodo.5960048">10.5281/zenodo.5960048</a>)</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="suplementary-material" class="level1">
<h1>Suplementary Material</h1>
<section id="methods-details" class="level4">
<h4 class="anchored" data-anchor-id="methods-details">Methods details</h4>
<section id="husbandry" class="level6">
<h6 class="anchored" data-anchor-id="husbandry">Husbandry</h6>
<p><em>Breeding colony</em> – We tested juveniles coming from a breeding colony established in the lab since 2019. There is a total of 270 and 180 adults of <em>L. delicata</em> and <em>L. guichenoti</em> respectively, housed in big containers (41.5 L x 30.5 W x 21 H cm) with six lizards (2 males and 4 females) per enclosure. Enclosures are provided with non-stick matting, shelter, and several small water dishes. Water is given daily, and they are fed approx. 40 mid-size crickets (<em>Acheta domestica</em>) per enclosure three days a week. Crickets are dusted with calcium weekly and multivitamin and calcium biweekly. To ensure a temperature gradient, we employ a heat chord and a heat lamp following a 12 h light:12 h dark cycle. Room temperatures are set to 22-24 Celsius, and warm side of enclosures is usually at 32 Celsius.<br>
<em>Eggs collection and incubation</em> – Between mid-October 2022 to the end of February 2023, we provided females with a place to lay the eggs by means of small boxes (12.5 L x 8.3 W x 5 H cm) with moist vermiculite inside, that were placed in one extreme of the communal enclosures (see above). We checked for the presence of eggs in the boxes three days a week. After collection, we measured length and width of eggs with a digital caliper to the nearest 0.1 mm and weight them with a (OHAUS, Model spx123) digital scale ± 0.001g error. Then eggs were treated with CORT or vehicle (see CORT and Temperature manipulation below) and were placed in individual cups (80 mL) with moist vermiculite (12 parts water to 4 parts vermiculite). The cups were covered with cling wrap to retain moisture and left in LATWIT 2X5D-R1160 incubators at two different temperatures (see CORT and Temperature manipulation below) until hatching.<br>
<em>Hatchlings</em> – Eggs in the incubator were checked three times a week for hatchlings. After hatchling, we measured juveniles’ SVL and Tail Length (TL) with a rule to the nearest mm and weighted them with a (OHAUS, Model spx123) digital scale ± 0.001g error. We then placed hatchlings in individual enclosures (18.7L x 13.2W x 6.3H cm) and provided them with non-stick matting and a small water dish. During this period, they were sprayed water every day and received 3-6 small <em>A. domestica</em> crickets three times a week. All care otherwise follows similar protocols to adults (see above).<br>
Two weeks before we started the training phase (see below), lizards were moved to the experimental arena for acclimatation. The arenas were individual medium size (41 L x 29.7 W x 22 H cm) plastic containers with a shelter (9 L x 6 W x 1.5 H cm) on one of the extremes and a water dish on the other. These new enclosures were placed in two rooms in 7 different racks associated to 7 different CCTV systems (device model DVR-HP210475) that allowed us to record their behaviour during the experiment (see details below). The number of lizards per species and treatment in each rack was counterbalanced to control for any effect of the room or the position of the lizard in the rack. During acclimatation and all the experiment, lizards were fed with only one cricket per day dusted with calcium and multivitamin (see protocol below), and water was supplied <em>ad libitum</em>. We provided a temperature gradient by means of a heat cord and heat lamps in a 12 h light: 12 h dark cycle. The rooms temperature was set to between 22-24 Celsius.</p>
</section>
<section id="cort-and-temperature-manipulation" class="level6">
<h6 class="anchored" data-anchor-id="cort-and-temperature-manipulation">CORT and Temperature manipulation</h6>
<p>To test empirically the effect of early environment we manipulated CORT concentration in eggs and incubated them under one of two temperature regimes (‘Cold’ – 23ºC ± 3ºC or ‘Hot’ – 30ºC ± 3ºC) in a 2x2 factorial design (<a href="#fig-Methods">Fig.&nbsp;1</a> A). We first allocated eggs to one of two different treatments: CORT treatment, where eggs were topically supplied with 5µL of CORT dissolved in 70% Ethanol and 30% DMSO (vehicle) at a final (10 pg CORT/mL) concentration (CORT treatment); and a Control treatment, where eggs received an equal volume of the vehicle. CORT concentration employed in the CORT treatment represents 2 standard deviations above the mean natural concentration obtained in eggs from both species (non-published data). Then, eggs were incubated in one of the two previously mentioned temperature regimes (‘Cold’ or ‘Hot’) until hatching. The number of eggs per clutch assigned to each hormone and temperature treatment were counterbalanced in both species.</p>
</section>
<section id="learning-task" class="level6">
<h6 class="anchored" data-anchor-id="learning-task">Learning task</h6>
<p>The habituation phase was divided into three stages: in the first stage, the reward, a small, frozen cricket (<em>A. domestica</em>) was placed in an opaque petri dish (3D x 1.6H cm) (<a href="#fig-Methods">Fig.&nbsp;1</a> B, Stage 1); in the second stage, the petri dish with the cricket was placed on top of the white 3D printed ramps (<a href="#fig-Methods">Fig.&nbsp;1</a> B, Stage 2); and in the third stage, the cricket was left inside a well (3D x 1.75H cm) on top of the ramp (Fig. <a href="#fig-Methods">Fig.&nbsp;1</a> B, Stage 3). Trials in every stage lasted one hour, begining when the feeding block (petri dish, ramp, or both) was placed inside the enclosure and finished when we took the feeding block away. We recorded whether the cricket had been consumed or not and we considered an stage as completed if the lizards ate the crickets in at least 5 out of 6 trials. This phase lasted 38 days, and only in one case we decided not to use the lizard in the next phases because its behaviour was not consistent.<br>
In the associative phase, we used three ramps that were identical in shape and size but differ in the colour (Associative task in Fig. <a href="#fig-Methods">Fig.&nbsp;1</a> B). As in the last stage of the habituation phase, we placed the cricket inside the wells of the ramps, but then two of them were covered with 3D-printed lids (3D x 0.5H cm) so prey was only accessible in “the correct” ramp. The food reward was placed in all three wells to avoid lizard using prey chemical cues, that were released in the closed wells thanks to a series of small holes on the top of the lids. The colours of the feeders were green, red, and blue, as previous studies demonstrate that squamates can discriminate between these colours <span class="citation" data-cites="Baden_Osorio_2019_Vert_vision">[<a href="#ref-Baden_Osorio_2019_Vert_vision" role="doc-biblioref">6</a>]</span>. However, we decided to split the lizards in two groups to control for potential colour preference that could bias our results. One group of lizards was assigned the blue ramp as the correct choice (i.e., the ramp with the non-covered frozen cricket) in the associative task and the red ramp in the reversal, while the other group was assigned red as correct for the associative and blue for the reversal. In all trials, the position of the feeders was changed randomly to ensure subjects were using colour rather than spatial cues for the association. Lizards were tested in this task once a day for 35 days. After the colour association phase, we performed a choice reversal task (Reversal task in <a href="#fig-Methods">Fig.&nbsp;1</a> B). Here, the attainability of prey was indicated by a different colour from the reversal, requiring the lizards to form a novel association between the new colour and the food reward. This test was done once a day for 40 days.<br>
We performed the full experiment was between the 6<sup>th</sup> of March until the 26<sup>th</sup> of June 2023, between 11 to 12 am, when the lizards were active. Trials in the learning phases (colour associative task and reversal tasks) were recorded with different CCTV systems always using the same camera per individual. Videos were analysed manually using a standard video player (IINA) by PR, who recorded whether the first choice made by each subject was the correct feeder or not. We considered a choice was made if the head of the lizard was inside the well of one of the ramps. We considered a trial failed if there was no choice in one hour of recording and those trials were considered as ‘non data’ in the analyses. We excluded from our analyses those individuals with more than 15 trials failed (i.e.&nbsp;they did not make a choice), and we considered the first trial to be the first one where the individual made a choice. We also considered individuals to be reinforced if the cricket was eaten after the test independently of whether their initial choice was correct or not.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="checking-the-models-plots" class="level4">
<h4 class="anchored" data-anchor-id="checking-the-models-plots">Checking the models plots</h4>
<p>Model formula for the reversal task is:<br>
Choice ~ trial_reversal<em>cort</em>temp + (1 + trial_reversal|lizard_id)<br>
Plots for the different models of the associative task:<br>
1.- <em>L. delicata</em></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate  Est.Error       Q2.5     Q97.5
R2 0.1095491 0.01830592 0.07439661 0.1450879</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_files/figure-html/plotmod_drr-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_files/figure-html/plotmod_drr-2.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_files/figure-html/plotmod_drr-3.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<p>2.- <em>L. guichenoti</em></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate  Est.Error      Q2.5     Q97.5
R2 0.1832124 0.02019234 0.1426662 0.2212409</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_files/figure-html/plotmod_grr-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_files/figure-html/plotmod_grr-2.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ms_files/figure-html/plotmod_grr-3.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>